<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Environment · Kokkos.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Kokkos.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../calling_c/">Calling a Kokkos library</a></li><li><a class="tocitem" href="../inaccessible_views/">Using views in an inaccessible memory space</a></li></ul></li><li class="is-active"><a class="tocitem" href>Environment</a><ul class="internal"><li><a class="tocitem" href="#Initialization"><span>Initialization</span></a></li><li><a class="tocitem" href="#Configuration"><span>Configuration</span></a></li><li><a class="tocitem" href="#Synchronization"><span>Synchronization</span></a></li><li><a class="tocitem" href="#Constants"><span>Constants</span></a></li></ul></li><li><a class="tocitem" href="../spaces/">Execution &amp; Memory Spaces</a></li><li><a class="tocitem" href="../views/">Views</a></li><li><a class="tocitem" href="../compilation/">Compilation</a></li><li><a class="tocitem" href="../library_management/">Library Management</a></li><li><a class="tocitem" href="../config_options/">Configuration options</a></li><li><a class="tocitem" href="../MPI/">MPI</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Environment</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Environment</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Keluaa/Kokkos.jl/blob/main/docs/src/environment.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Environment"><a class="docs-heading-anchor" href="#Environment">Environment</a><a id="Environment-1"></a><a class="docs-heading-anchor-permalink" href="#Environment" title="Permalink"></a></h1><h2 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Kokkos.initialize" href="#Kokkos.initialize"><code>Kokkos.initialize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialize(;
    num_threads=nothing,
    device_id=nothing, map_device_id_by=nothing,
    disable_warnings=nothing, print_configuration=nothing,
    tune_internals=nothing,
    tools_libs=nothing, tools_args=nothing
)</code></pre><p>Initializes Kokkos by calling <a href="https://kokkos.github.io/kokkos-core-wiki/API/core/initialize_finalize/initialize.html"><code>Kokkos::initialize()</code></a>.</p><p>The keyword arguments build are passed to the <a href="https://kokkos.github.io/kokkos-core-wiki/API/core/initialize_finalize/InitializationSettings.html"><code>InitializationSettings</code></a> constructor which is then passed to <code>Kokkos::initialize()</code>. A value of <code>nothing</code> keeps the default behaviour of Kokkos.</p><p>The Kokkos wrapper library is loaded (and recompiled if needed) if it is not already the case. This locks the current <a href="../config_options/#Configuration-Options">Configuration Options</a> until the end of the current Julia session.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L72-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.is_initialized" href="#Kokkos.is_initialized"><code>Kokkos.is_initialized</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_initialized()</code></pre><p>Return <code>Kokkos::is_initialized()</code>.</p><p>Can be called before the wrapper library is loaded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L138-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.finalize" href="#Kokkos.finalize"><code>Kokkos.finalize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">finalize()</code></pre><p>Calls <a href="https://kokkos.github.io/kokkos-core-wiki/API/core/initialize_finalize/finalize.html"><code>Kokkos::finalize()</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Kokkos requires that all view destructors should be called <strong>before</strong> calling <code>finalize</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L125-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.is_finalized" href="#Kokkos.is_finalized"><code>Kokkos.is_finalized</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_finalized()</code></pre><p>Return <code>Kokkos::is_finalized()</code>.</p><p>Can be called before the wrapper library is loaded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L149-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.KokkosWrapper.load_wrapper_lib" href="#Kokkos.KokkosWrapper.load_wrapper_lib"><code>Kokkos.KokkosWrapper.load_wrapper_lib</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_wrapper_lib(; no_compilation=false, no_git=false, loading_bar=true)</code></pre><p>Configures, compiles then loads the wrapper library using the current <a href="../config_options/#Configuration-Options">Configuration Options</a>.</p><p>After calling this method, all configuration options become locked.</p><p>If <code>no_compilation</code> is <code>true</code>, then the CMake project of the wrapper library will not be configured or compiled.</p><p>If <code>no_git</code> is <code>true</code>, then if we need to use the Kokkos installation of the package, no Git operations (clone + checkout) will be done.</p><p>Both <code>no_compilation=true</code> and <code>no_git=true</code> are needed when initializing Kokkos.jl in non-root MPI processes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/kokkos_wrapper.jl#L213-L228">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.is_kokkos_wrapper_loaded" href="#Kokkos.is_kokkos_wrapper_loaded"><code>Kokkos.is_kokkos_wrapper_loaded</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_kokkos_wrapper_loaded()</code></pre><p>Return <code>true</code> if <a href="#Kokkos.KokkosWrapper.load_wrapper_lib"><code>load_wrapper_lib</code></a> has been called.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/Kokkos.jl#L51-L55">source</a></section></article><h2 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Kokkos.build_in_scratch" href="#Kokkos.build_in_scratch"><code>Kokkos.build_in_scratch</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build_in_scratch()</code></pre><p>Sets the <code>build_dir</code> configuration option to a scratch directory (the default).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/configuration.jl#L164-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.build_in_tmp" href="#Kokkos.build_in_tmp"><code>Kokkos.build_in_tmp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build_in_tmp()</code></pre><p>Sets the <code>build_dir</code> configuration option to a temporary directory, cleaned at the end of the Julia session.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/configuration.jl#L172-L177">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.build_in_project" href="#Kokkos.build_in_project"><code>Kokkos.build_in_project</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build_in_project(name = &quot;.kokkos-build&quot;)</code></pre><p>Sets the <code>build_dir</code> configuration option to the directory <code>name</code> in the active project directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/configuration.jl#L181-L185">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.require" href="#Kokkos.require"><code>Kokkos.require</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">require(;
    version=nothing,
    dims=nothing, types=nothing, layouts=nothing,
    idx=nothing,
    exec_spaces=nothing, mem_spaces=nothing,
    no_error=false
)</code></pre><p>Asserts that the underlying Kokkos wrapper library of <code>Kokkos.jl</code> respects the given requirements.</p><p>An argument with a value of <code>nothing</code> is considered to have no requirements.</p><p><code>version</code> checks for the version of Kokkos.</p><p><code>idx</code> checks the type of the index variables used when accessing a view.</p><p><code>version</code> and <code>idx</code> are given as callables returning a <code>Bool</code> and taking a single argument: respectively a <code>VersionNumber</code> and a <code>Type</code>, e.g. passing <code>version = &gt;=(v&quot;4.0.0&quot;)</code> will match all Kokkos versions including <code>v4.0.0</code> and above.</p><p><code>dims</code>, <code>types</code>, <code>layouts</code>, <code>exec_spaces</code> and <code>mem_spaces</code> are lists of the required values. </p><p><code>dims</code>, <code>types</code> and <code>layouts</code> check the available dimensions, types and layouts of views, while <code>exec_spaces</code> and <code>mem_spaces</code> do the same for execution and memory spaces.</p><p>If <code>no_error</code> is true, then this function will return <code>false</code> if any requirement is not met.</p><p>This function does not require for Kokkos to be initialized, but for the wrapper library to be loaded. If the wrapper is not loaded, the configuration options will be checked instead, however they cannot cover all possible requirements (<code>idx</code> and <code>mem_spaces</code> do not work and <code>version</code> works only if the packaged Kokkos installation is used).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Require Kokkos version 4.0.0 (exactly), and for 1D and 2D views of Float64 to be compiled with
# a column or row major layout:
Kokkos.require(;
    version = ==(v&quot;4.0.0&quot;),
    types = [Float64],
    dims = [1, 2],
    layouts = [Kokkos.LayoutLeft, Kokkos.LayoutRight]    
)

# Require an index type of 8 bytes, the Cuda and OpenMP backends of Kokkos, as well as the Cuda UVM
# memory space to be available:
Kokkos.require(;
    idx = (==(8) ∘ sizeof),
    exec_spaces = [Kokkos.Cuda, Kokkos.OpenMP],
    mem_spaces = [Kokkos.CudaUVMSpace]
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L334-L389">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.configinfo" href="#Kokkos.configinfo"><code>Kokkos.configinfo</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">configinfo(io::IO = stdout)</code></pre><p>Print information about all configuration options.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L171-L175">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.versioninfo" href="#Kokkos.versioninfo"><code>Kokkos.versioninfo</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">versioninfo(io::IO = stdout; internal=true, verbose=false)</code></pre><p>Print the version and various information about the underlying Kokkos library.</p><p>If <code>internal</code> is true, <code>Kokkos::print_configuration()</code> is called. <code>verbose</code> is passed to that call.</p><p>This function does not require for Kokkos to be initialized, however if <code>internal=true</code> then the output will be incomplete.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L202-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.print_configuration" href="#Kokkos.print_configuration"><code>Kokkos.print_configuration</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">print_configuration(io::IO, verbose::Bool)</code></pre><p>Prints the internal Kokkos configuration to <code>io</code>.</p><p>Equivalent to <code>Kokkos::print_configuration(out, verbose)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L114-L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Kokkos.set_omp_vars" href="#Kokkos.set_omp_vars"><code>Kokkos.set_omp_vars</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_omp_vars(;
    places = &quot;cores&quot;,
    bind = &quot;close&quot;,
    num_threads = Threads.nthreads()
)</code></pre><p>Helper function to set the main OpenMP environment variables used by Kokkos. It must be called before calling <a href="#Kokkos.initialize"><code>initialize</code></a>.</p><p><code>places</code> sets <code>OMP_PLACES</code>. <code>bind</code> sets <code>OMP_PROC_BIND</code>. <code>num_threads</code> sets <code>OMP_NUM_THREADS</code>.</p><p>Note that since Julia threads and OpenMP threads are decoupled, there is no constraint imposed by Julia on OpenMP threads: there can be as many threads as needed.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Pinning the Julia threads with <a href="https://github.com/carstenbauer/ThreadPinning.jl">ThreadPinning.jl</a> or with the <code>JULIA_EXCLUSIVE</code> environment variable can have an impact on OpenMP thread affinities, making the OpenMP variables useless.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L2-L24">source</a></section></article><h2 id="Synchronization"><a class="docs-heading-anchor" href="#Synchronization">Synchronization</a><a id="Synchronization-1"></a><a class="docs-heading-anchor-permalink" href="#Synchronization" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Kokkos.fence-Tuple{}" href="#Kokkos.fence-Tuple{}"><code>Kokkos.fence</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fence()
fence(label::String)</code></pre><p>Wait for all asynchronous Kokkos operations to complete.</p><p>Equivalent to <a href="https://kokkos.github.io/kokkos-core-wiki/API/core/parallel-dispatch/fence.html"><code>Kokkos::fence()</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L160-L167">source</a></section></article><h2 id="Constants"><a class="docs-heading-anchor" href="#Constants">Constants</a><a id="Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Constants" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Kokkos.KOKKOS_VERSION" href="#Kokkos.KOKKOS_VERSION"><code>Kokkos.KOKKOS_VERSION</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">KOKKOS_VERSION::VersionNumber</code></pre><p>The Kokkos version currently loaded.</p><p><code>nothing</code> if Kokkos is not yet loaded. See <a href="../config_options/#kokkos_version">kokkos_version</a> for the version of the packaged installation of Kokkos, which is defined before loading Kokkos.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Keluaa/Kokkos.jl/blob/f807e69dc0f0df4bab35ff5d7b38fbdbff14de78/src/utils.jl#L414-L422">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inaccessible_views/">« Using views in an inaccessible memory space</a><a class="docs-footer-nextpage" href="../spaces/">Execution &amp; Memory Spaces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 23 May 2023 08:35">Tuesday 23 May 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
